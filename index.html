<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <script>
    (function(){
      const m=matchMedia('(prefers-color-scheme: light)').matches;
      document.documentElement.className = m ? 'light' : 'dark';
    })();
  </script>

  <script>
    (function () {
      var isSupported = true;
      try {
        new Function('async function a(){ const b = {}; return b?.c ?? 1; }');
        if (typeof window.fetch !== 'function' || typeof window.Map !== 'function') {
          isSupported = false;
        }
      } catch (e) {
        isSupported = false;
      }
      if (!isSupported) {
        window.location.href = '/unsupported-browser.html';
      }
    })();
  </script>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Open E→C Dictionary</title>
  <meta name="description" content="一个开源、离线可用的英汉词典">

  <link rel="preconnect" href="https://api.dictionaryapi.dev">
  <link rel="dns-prefetch" href="https://api.dictionaryapi.dev">

  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Open Dict">
  <meta name="theme-color" content="#111315">
  <link rel="apple-touch-icon" href="/pwa-192x192.png">
  <link rel="manifest" href="/manifest.webmanifest">

  <script type="module" src="/src/main.js" defer></script>
</head>

<body class="min-h-screen bg-background text-on-background font-sans">
  <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:z-50 focus:top-4 focus:left-4 focus:px-4 focus:py-2 focus:bg-primary-container focus:text-on-primary-container focus:rounded-lg">
    跳到主要内容
  </a>

  <div id="main-content" role="main" class="mx-auto flex min-h-screen max-w-5xl flex-col gap-8 px-4 py-12">
    <header class="flex flex-col gap-4 text-center sm:flex-row sm:items-start sm:justify-between sm:text-left">
      <div class="space-y-3">
        <h1 class="text-3xl font-medium tracking-tight text-on-surface sm:text-4xl">
          Open English → Chinese Dictionary
        </h1>
      </div>
    </header>

    <main class="flex flex-col gap-6">
      <section class="rounded-3xl bg-surface-container p-6 shadow-soft" aria-labelledby="search-heading">
        <h2 id="search-heading" class="sr-only">搜索单词</h2>
        
        <form id="searchForm">
          <div class="relative" id="search-component-wrapper">
            <label for="searchInput" class="absolute -top-2 left-3 z-10 bg-surface-container px-1 text-xs font-medium uppercase tracking-wider text-on-surface-variant">
              搜索单词
            </label>
            <input
              id="searchInput"
              type="search"
              placeholder="例如：ability"
              autocomplete="off"
              minlength="1"
              enterkeyhint="search"
              class="relative w-full rounded-lg border-2 border-transparent bg-surface-container-high px-4 py-3 pr-14 text-lg text-on-surface outline-none transition-colors duration-200 focus:border-primary focus:bg-surface-container-highest"
              aria-controls="suggestion-list"
              aria-autocomplete="list"
            />
            <button 
              type="submit" 
              aria-label="搜索"
              id="searchButton"
              class="absolute right-2 top-1/2 flex h-10 w-10 -translate-y-1/2 items-center justify-center rounded-full text-on-surface-variant transition-colors duration-200 hover:bg-surface-container-highest hover:text-on-surface focus:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 focus-visible:ring-offset-surface-container-high overflow-hidden"
            >
              <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor">
                <path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/>
              </svg>
            </button>
            
            <div id="suggestion-list" 
                 class="suggestion-list invisible absolute top-full z-20 mt-2 w-full origin-top transform-gpu overflow-hidden rounded-2xl bg-surface-container-high shadow-xl opacity-0 scale-95"
                 role="listbox"
            >
            </div>
          </div>
        </form>

        <div id="statusMessage" class="mt-4 text-sm text-on-surface-variant" role="status" aria-live="polite"></div>
      </section>

      <section class="rounded-3xl bg-surface-container p-6 shadow-soft" aria-labelledby="result-heading" aria-live="polite">
        <h2 id="result-heading" class="text-lg font-semibold text-on-surface">词条详情</h2>
        <div id="entryView" class="prose dark:prose-invert mt-2 max-w-none prose-p:text-on-surface-variant prose-h3:text-on-surface prose-h4:text-primary">
          <p>输入单词并按回车键进行搜索。</p>
        </div>
      </section>
    </main>
  </div>

  <template id="entryTemplate">
    <article class="space-y-8">
      <header class="space-y-2">
        <div class="flex flex-wrap items-baseline gap-x-3 gap-y-1">
          <h3 data-field="word" class="text-3xl font-semibold tracking-tight"></h3>
          <div class="flex items-center gap-2">
            <span data-field="pronunciation" class="rounded-full bg-surface-container-high px-3 py-1 text-sm tracking-wide text-on-surface-variant"></span>
            <button
              type="button"
              data-action="play-audio"
              class="audio-button hidden"
              aria-label="播放发音"
            >
            </button>
          </div>
        </div>
        <p data-field="concise_definition" class="text-base"></p>
      </header>
      <section class="space-y-3">
        <h4>词形变化</h4>
        <dl data-field="forms" class="grid gap-3 rounded-2xl bg-surface-container-high p-4 sm:grid-cols-2"></dl>
      </section>
      <section class="space-y-3">
        <h4>详细释义</h4>
        <div data-field="definitions" class="space-y-4"></div>
      </section>
      <section class="space-y-3">
        <h4>近义词比较</h4>
        <div data-field="comparison" class="space-y-3"></div>
      </section>
    </article>
  </template>
  
  <script type="module" async src="/src/compatibility-check.js"></script>
</body>
</html>
