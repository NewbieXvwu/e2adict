# 工作流名称
name: Sync Dictionary to Claw Cloud Object Storage

# 触发工作流的事件
on:
  workflow_dispatch:

# 工作流任务
jobs:
  sync-files:
    # 运行环境
    runs-on: ubuntu-latest

    # 任务步骤
    steps:
      # 第一步：检出（下载）你的仓库代码到运行环境中
      - name: Checkout repository
        uses: actions/checkout@v4

      # 第二步：使用 aws-cli 同步文件，并通过 env 设置凭证
      - name: Sync dictionary folder to Claw Cloud
        env:
          # 将 Secrets 设置为 aws-cli 所需的环境变量
          AWS_ACCESS_KEY_ID: ${{ secrets.CLAW_CLOUD_ACCESS_KEY_ID }}
          AWS_SECRET_ACCESS_KEY: ${{ secrets.CLAW_CLOUD_SECRET_ACCESS_KEY }}
          AWS_REGION: eu-central-1
        run: |
          aws s3 sync ./dictionary s3://${{ secrets.CLAW_CLOUD_BUCKET_NAME }}/ \
            --endpoint-url https://objectstorageapi.eu-central-1.clawcloudrun.com \
            --acl public-read \
            --delete
